<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en" />
  <link rel="shortcut icon" href="./ressources/img/favicon.ico">
  <link rel="stylesheet" href="./ressources/style.css" type="text/css" />

  <script type="text/javascript" src="ressources/js/jquery-1.9.0.min.js"></script>
  <script type="text/javascript" src="ressources/js/date.format.js"></script>
  <script type="text/javascript" src="ressources/js/settings.js"></script>
  <script type="text/javascript" src="ressources/js/common.js"></script>

  <link rel="stylesheet" href="./ressources/leaflet/leaflet.css">
  <script type="text/javascript" src="./ressources/leaflet/leaflet.js"></script>

  <title>UBPE2013@Valence | Home</title>
</head>

<body>
  <div id="big-frame">

    <div id="menu">
      <ul>
        <li><a href="data-filtered-all.html">Data</a></li>
        <li><a href="charts.html">Charts</a></li>
        <li><a href="map-online.html">Map</a></li>
        <li><a href="data-raw-all.html">Raw data</a></li>
      </ul>
    </div><!-- end menu -->

    <div id="frame">
      <div id="page-content">
        <div id="map" style="width: 50%; height: 50%">
          <script>
            // Create the map.
            var map = L.map('map', settings.map);

            L.tileLayer("http://mt{s}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}",
                        {
                          subdomains : '0123',
                          attribution : 'UBPE 2013 - IUT Valence',
                          maxZoom : 18,
                          minZoom : 0
                        }).addTo(map);

            for (i in settings.POI) {
              L.marker([ settings.POI[i][0], settings.POI[i][1] ], {zIndexOffset : 15000})
              .addTo(map)
              .bindPopup("<div style=\"color : black\">" + settings.POI[i][2] + "</div>");
            }

            // Custom icons.
            var SmallIcon = L.Icon.extend({  // Create the "small icon" class.
              options: {
                iconSize : [20, 20],  // size of the icon
                iconAnchor : [10, 10],  // point of the icon which will correspond to marker's location
                popupAnchor : [0, -5]  // point from which the popup should open relative to the iconAnchor
              }
            });

            var greyIcon = new SmallIcon({iconUrl : settings.map['speedIconsPath'] + "/grey.png"});
            var blueIcon = new SmallIcon({iconUrl : settings.map['speedIconsPath'] + "/blue.png"});
            var greenIcon = new SmallIcon({iconUrl : settings.map['speedIconsPath'] + "/green.png"});
            var orangeIcon = new SmallIcon({iconUrl : settings.map['speedIconsPath'] + "/orange.png"});
            var redIcon = new SmallIcon({iconUrl : settings.map['speedIconsPath'] + "/red.png"});

            var burstIcon = L.icon({
              iconUrl : settings.map['speedIconsPath'] + "/burst.png",
              iconSize : [60, 60],
              iconAnchor : [30, 30],
              popupAnchor : [0, -5]
            });

            updateData();  // Update the data and map it.
          </script>
        </div>
        <br/>
        <div id="lastFrame">
          <div id="tab2">
            <table>
              <tr id="type-tile"></tr>
              <tr id="type-1"></tr>
            </table>
          </div>

          <script>
            var titles = [];
            settings.dataBriefLabels.forEach(function(label, index, array) {
              var title = settings.fieldLabels[label];
              if (settings.fieldUnits[label]) {
                title += "<br />(" + settings.fieldUnits[label] + ")";
              }
              titles.push(title);
            });
            $('#type-tile').append('<th>' + titles.join('</th><th>') + '</th>');
          </script>

        </div>
      </div><!-- end page -->
    </div><!-- end frame -->

    <div id="footer">
      <div id="footer-left">UBPE2013@Valence - UBPE project team, IUT Valence</div>
      <div id="footer-right">
        <ul>
          <li><a href="http://iut-valence.fr"><img
              src="./ressources/img/logoiut2.png" title="IUT Valence"
              alt="Logo IUT Valence"></a></li>
        </ul>
      </div>
    </div><!-- end footer -->
  </div>
</body>
</html>
